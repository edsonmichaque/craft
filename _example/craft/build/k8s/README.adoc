= Kubernetes Deployment Guide
:toc: left
:source-highlighter: highlight.js

== Overview

This directory contains Kubernetes manifests for deploying craft using Kustomize for environment management.

== Directory Structure

[source]
----
k8s/
├── base/                 # Base Kubernetes manifests
│   ├── deployment.yml
│   ├── service.yml
│   ├── configmap.yml
│   ├── secret.yml
│   └── kustomization.yml
└── overlays/            # Environment-specific configurations
    ├── dev/
    ├── staging/
    └── prod/
----

== Quick Start

=== Prerequisites

* kubectl installed and configured
* Access to a Kubernetes cluster
* craft Docker image built and available

=== Deployment

1. Set environment variables:
[source,bash]
----
# Required variables
export APP_NAME=craft
export NAMESPACE=craft
export IMAGE_REPOSITORY=your-registry/craft
export IMAGE_TAG=latest

# Optional overrides
export PORT=8080
export REPLICAS=3
export ENV=production
----

2. Deploy to an environment:
[source,bash]
----
# Development
kubectl apply -k overlays/dev

# Staging
kubectl apply -k overlays/staging

# Production
kubectl apply -k overlays/prod
----

== Configuration

=== Environment Variables

[cols="2,1,2"]
|===
|Variable |Default |Description

|APP_NAME
|craft
|Application name

|NAMESPACE
|craft
|Kubernetes namespace

|PORT
|8080
|Container port

|REPLICAS
|3
|Number of replicas

|ENV
|production
|Environment name
|===

=== ConfigMaps and Secrets

* *craft-env*: Environment variables
* *craft-config*: Application configuration
* *craft-secrets*: Sensitive data

== Monitoring

=== Health Checks

* Liveness: health
* Readiness: ready

=== Resource Management

[source,yaml]
----
resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 500m
    memory: 512Mi
----